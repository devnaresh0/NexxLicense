<div class="audit-container">
  <div class="audit-header">
    <h1 class="audit-title">Audit Trail for {{ domain }}</h1>
  </div>

  <div *ngIf="loading" class="loading-message">Loading...</div>
  <div *ngIf="error" class="error-message">{{ error }}</div>

  <div class="table-container" *ngIf="!loading && !error">
    <table class="details-table">
      <thead>
        <tr class="table-header">
          <th>#</th>
          <th>Action</th>
          <th>Customer</th>
          <th>Modules Count</th>
          <th>Modules Detail</th>
          <th>Timestamp</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let a of audits; let i = index" class="table-row">
          <td>{{ i + 1 }}</td>
          <td>{{ a.action }}</td>
          <td>{{ parseJson(a.newData)?.customerName || 'â€”' }}</td>
          <td>{{ parseJson(a.newData)?.modules?.length || 0 }}</td>
          <td>
            <ul class="module-list">
              <li *ngFor="let m of parseJson(a.newData)?.modules">
                {{ m.moduleName }} ({{ m.numberOfUsers }} users)
              </li>
              <li *ngIf="!parseJson(a.newData)?.modules?.length">No modules</li>
            </ul>
          </td>
          <td>{{ a.timestamp | date: 'dd-MM-yyyy HH:mm:ss' }}</td>
        </tr>
        <tr *ngIf="audits.length === 0" class="no-data-row">
          <td colspan="6" class="no-data">No audit records found.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>